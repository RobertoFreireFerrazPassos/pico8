pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
-- constants
trail_lifetime = 120

function getnewtrail()
	return {color = 0, timestamp = 0}
end

function _init()
 p = {
		x = 64,
		y = 64
	}
	
 trail_color = 7

 screen_buffer = {}
 for i=0,127 do
   screen_buffer[i] = {}
   for j=0,127 do
    screen_buffer[i][j] = getnewtrail()
   end
 end

 frame_count = 0
end

function _update()
	frame_count += 1
	
	if btn(0) then p.x = max(p.x - 1, 0) end -- left
	if btn(1) then p.x = min(p.x + 1, 127) end -- right
	if btn(2) then p.y = max(p.y - 1, 0) end -- up
	if btn(3) then p.y = min(p.y + 1, 127) end -- down
	
	screen_buffer[p.x+4][p.y+4] = {color = trail_color, timestamp = frame_count}
end

function _draw()
	cls()
	
	for i=0,127 do
	 for j=0,127 do
	  local cell = screen_buffer[i][j]
	  if cell.color ~= 0 then
	   -- check if the trail should still be visible
	   if frame_count - cell.timestamp < trail_lifetime then
	    pset(i, j, cell.color)
	   else
     -- clear the cell if the trail has expired
     screen_buffer[i][j] = getnewtrail()
	   end
	  end
	 end
	end
	
	spr(1,p.x,p.y)
end
__gfx__
00000000555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000005cccccc50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007005cccccc50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770005cccccc50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770005cccccc50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007005cccccc50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000005cccccc50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
